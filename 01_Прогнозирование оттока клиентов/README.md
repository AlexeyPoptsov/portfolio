### 1.Проект прогнозирования оттока клиентов в телеком.


***Суть задачи, по известным характеристикам пользователя и набору используемых услуг классифицировать клиентов склонных
к уходу.*** Решена типовая задача классификации с полным циклом работы с данными. Объединение
нормализация исходных данных, этап фиче инжиниринга в том числе с
предварительной кластеризацией пользователей и задачей балансировки классов, подбор
оптимальной для данной задачи модели.

В данном проекте использовались две модели ***LogisticRegression***
из ***sklearn*** и ***CatBoostClassifier*** из ***catboost***. Блок тюнинга параметров моделей выполнен в два этапа.
Грубый этап поиска параметров с использованием ***RandomizedSearchCV***, далее более точный поиск возле
полученных центров с использованием ***GridSearchCV***

В проекте оптимизировалась метрика ***roc_auc***, наилучшее полученное значение на тестовых данных ***0.84.***

### План проекта
1. Объединение данных в одну таблицу. Персоны и контракты количество совпадает, пользователи интернет и телефонной связи количество строк меньше, пропуски скорее всего заполним None и это значение будет как новая категория. Далее пользователей только интернет, только телефонии и того и другого тоже категоризирую, возможно буду делать разные модели, либо это будт просто новый признак.
2. Новые фичи. Пока видится только срок пользования например в месяцах. Возможно еще год заключения договора.
3. Кодование категориальных признаков. Пока по ощущениям буду использова OHE кодирование, количество полей не очень большое и количество значений тоже. Для регрессионной модели подойдет, для деревянных моделей возможно применю боле хитрое кодирование типа закодирую числовой вероятностью этой категории по целевому признаку.
4. Дисбаланс классов. Скорее всего придется слегка докинуть целевого класса например методом UpSampling. Возможно балансировку сделаю средтвами модели балансировкой весов.
5. Выполню нормализацию. Разобью на тестовую и тренировочные выборки. Т.к. это не временной ряд, то с перемешиванием и соблюдением баланса классов.
6. Выбор модели. Пока по ощущениям буду использовать Регрессию c регуляризацией и каойто бустинг над деревьями типа LGBM и CatBoost. Дальше что лучше подойдет.
7. Метрики. ROC_AUC, accuracy
8. Тюннинг моделей. сначала RandomizedSearchCV затем возле лучших значений более точный поиск GridSearchCV

---

### Некоторые визуализации проекта

**_Анализ таргета_**

![](https://i.ibb.co/mq7TLsD/image.png)

**_Анализ категориальных переменных_**
![](https://i.ibb.co/d6WD1Vn/image.png)
![](https://i.ibb.co/HYh3Sm4/image.png)

**_Предварительная кластеризация пользователей_**
![](https://i.ibb.co/yf3vH3f/image.png)
![](https://i.ibb.co/gJLtTFR/image.png)

**_Генерация фич и оценка взаимокореляции_**
![](https://i.ibb.co/sssKrMj/image.png)

**_Настройка гиперпараметров_**
![](https://i.ibb.co/D4QDKyh/image.png)

**_ROC кривая_**

![](https://i.ibb.co/5Tcyz5X/image.png)

**_Оценка важности фич_**

![](https://i.ibb.co/rG8FS6H/image.png)


